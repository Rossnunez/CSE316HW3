{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { createContext, StrictMode, useState } from 'react';\nimport jsTPS from '../common/jsTPS';\nimport api from '../api';\nimport MoveSong_Transaction from '../transactions/MoveSong_Transaction';\nimport AddSong_Transaction from '../transactions/AddSong_Transaction';\nimport EditSong_Transaction from '../transactions/EditSong_Transaction';\nexport const GlobalStoreContext = /*#__PURE__*/createContext({});\n/*\n    This is our global data store. Note that it uses the Flux design pattern,\n    which makes use of things like actions and reducers. \n    \n    @author McKilla Gorilla ------------------> DATA STORE MAINTAINS STATES OF THE APPLICATION\n    AWAIT -> \n    API.FUNCTION(updatePlaylistById) THAT IS THE CLIENT SIDE API WHICH GENERATES MESSAGES TO SEND TO THE BKEND\n    Send a request over to the server and await wants the code to sit there and wait for a response it can only be used if the method youre calling returns something like a PROMISE \n    PROMISE is a JS Object, if a function returns a promise we can AWAIT until its compoletely done(it will do it or tell you it failed)\n    AWAIT basically will wait for that response\n    WHEN YOU WANT TO SEND MESSAGES TO THE SERVER YOU HAVE TO WAIT, YOU DONT WANT THE CODE TO JUST GO\n    IN JS THERE ARE ASYNC FUNCTION MEANS DONT WAIT FOR ME\n    ASYNC means that code can be run in a seperate thread while the code keeps going\n    the only time we call await to send a http req to the server\n    the reason we call await in async function is so you can wait on another thread and not the main thread\n    *this is **FLUX ARCHIECTURE** USED FOR UI LIBRARIES\n    REDUCER IS AN ABSTRACT STATE UPDATE, it just returns a new state and you use that to update the state\n    useCONtext allows the store to be shared with all react components\n    Hooks let us avoid using lifecycle functions\n    useState allows use to create a state? maybe idk\n    use in the frontend is a hook function\n    Reducer is purely functional prog, you give it an intial state and action and it will produce a new state, and abstract of updating the state\n    reducer is usually called by a dispatch method\n    reducer is good to know and used in many apis\n    redux api would define reducer\n    there is a useReducer hook, were not using useReducer \n    useEffect(another hook function)    \n    ROUTER BACKEND IS REALLY MIDDLEWEAR AND the router deciders if a function is like thst send it so the handler\n    FRONT END ROUTER IS ABOUT SELECTING WHICH REACT COMPONENETS SHOULD BE USED\n    2 ways to get to ROUTE\n    1. we might have a link, react router link(link object or dynamic link)\n    2. GET THE useHistory HOOK, AND PUSH YOU TO ANOTHER LIKE(YOU WILL SEE IT DONE THIS WAY)\n    run the program comment out that line see what happens, uncomment and see what happens youll see a difference \n    \n*/\n// THESE ARE ALL THE TYPES OF UPDATES TO OUR GLOBAL\n// DATA STORE STATE THAT CAN BE PROCESSED\n\nexport const GlobalStoreActionType = {\n  CHANGE_LIST_NAME: \"CHANGE_LIST_NAME\",\n  CLOSE_CURRENT_LIST: \"CLOSE_CURRENT_LIST\",\n  CREATE_NEW_LIST: \"CREATE_NEW_LIST\",\n  LOAD_ID_NAME_PAIRS: \"LOAD_ID_NAME_PAIRS\",\n  SET_CURRENT_LIST: \"SET_CURRENT_LIST\",\n  SET_LIST_NAME_EDIT_ACTIVE: \"SET_LIST_NAME_EDIT_ACTIVE\",\n  MARK_SONG_FOR_EDIT: \"MARK_SONG_FOR_EDIT\"\n}; // WE'LL NEED THIS TO PROCESS TRANSACTIONS\n\nconst tps = new jsTPS(); // WITH THIS WE'RE MAKING OUR GLOBAL DATA STORE\n// AVAILABLE TO THE REST OF THE APPLICATION\n\nexport const useGlobalStore = () => {\n  _s();\n\n  // THESE ARE ALL THE THINGS OUR DATA STORE WILL MANAGE\n  const [store, setStore] = useState({\n    idNamePairs: [],\n    currentList: null,\n    newListCounter: 0,\n    listNameActive: false,\n    listMarkedForDeletion: null,\n    nameOfDeletedList: null,\n    songToEdit: null,\n    indexOfSong: null\n  }); // HERE'S THE DATA STORE'S REDUCER, IT MUST\n  // HANDLE EVERY TYPE OF STATE CHANGE\n\n  const storeReducer = action => {\n    const {\n      type,\n      payload,\n      index\n    } = action;\n\n    switch (type) {\n      // LIST UPDATE OF ITS NAME\n      case GlobalStoreActionType.CHANGE_LIST_NAME:\n        {\n          return setStore({\n            idNamePairs: payload.idNamePairs,\n            currentList: payload.playlist,\n            newListCounter: store.newListCounter,\n            listNameActive: false,\n            listMarkedForDeletion: null\n          });\n        }\n      // STOP EDITING THE CURRENT LIST\n\n      case GlobalStoreActionType.CLOSE_CURRENT_LIST:\n        {\n          return setStore({\n            idNamePairs: store.idNamePairs,\n            currentList: null,\n            newListCounter: store.newListCounter,\n            listNameActive: false,\n            listMarkedForDeletion: null,\n            nameOfDeletedList: null,\n            songToEdit: null\n          });\n        }\n      // CREATE A NEW LIST\n\n      case GlobalStoreActionType.CREATE_NEW_LIST:\n        {\n          return setStore({\n            idNamePairs: store.idNamePairs,\n            currentList: payload,\n            newListCounter: store.newListCounter + 1,\n            listNameActive: false,\n            listMarkedForDeletion: null\n          });\n        }\n      // GET ALL THE LISTS SO WE CAN PRESENT THEM\n\n      case GlobalStoreActionType.LOAD_ID_NAME_PAIRS:\n        {\n          return setStore({\n            idNamePairs: payload,\n            currentList: null,\n            newListCounter: store.newListCounter,\n            listNameActive: false,\n            listMarkedForDeletion: null\n          });\n        }\n      // PREPARE TO DELETE A LIST\n\n      case GlobalStoreActionType.MARK_LIST_FOR_DELETION:\n        {\n          return setStore({\n            idNamePairs: store.idNamePairs,\n            currentList: null,\n            newListCounter: store.newListCounter,\n            listNameActive: false,\n            listMarkedForDeletion: payload._id,\n            nameOfDeletedList: payload.name\n          });\n        }\n      //PREPARE TO EDIT SONG\n\n      case GlobalStoreActionType.MARK_SONG_FOR_EDIT:\n        {\n          return setStore({\n            idNamePairs: store.idNamePairs,\n            currentList: store.currentList,\n            newListCounter: store.newListCounter,\n            listNameActive: false,\n            listMarkedForDeletion: null,\n            nameOfDeletedList: null,\n            songToEdit: payload,\n            indexOfSong: index\n          });\n        }\n      // UPDATE A LIST\n\n      case GlobalStoreActionType.SET_CURRENT_LIST:\n        {\n          return setStore({\n            idNamePairs: store.idNamePairs,\n            currentList: payload,\n            newListCounter: store.newListCounter,\n            listNameActive: false,\n            listMarkedForDeletion: null\n          });\n        }\n      // START EDITING A LIST NAME\n\n      case GlobalStoreActionType.SET_LIST_NAME_EDIT_ACTIVE:\n        {\n          return setStore({\n            idNamePairs: store.idNamePairs,\n            currentList: payload,\n            newListCounter: store.newListCounter,\n            listNameActive: true,\n            listMarkedForDeletion: null\n          });\n        }\n\n      default:\n        return store;\n    }\n  }; // THESE ARE THE FUNCTIONS THAT WILL UPDATE OUR STORE AND\n  // DRIVE THE STATE OF THE APPLICATION. WE'LL CALL THESE IN \n  // RESPONSE TO EVENTS INSIDE OUR COMPONENTS.\n  // THIS FUNCTION PROCESSES CHANGING A LIST NAME\n\n\n  store.changeListName = function (id, newName) {\n    // GET THE LIST\n    async function asyncChangeListName(id) {\n      let response = await api.getPlaylistById(id);\n\n      if (response.data.success) {\n        let playlist = response.data.playlist; //bruh playlist was spelled wrong\n        //console.log(playlist);\n\n        playlist.name = newName;\n\n        async function updateList(playlist) {\n          response = await api.updatePlaylistById(playlist._id, playlist);\n\n          if (response.data.success) {\n            async function getListPairs(playlist) {\n              response = await api.getPlaylistPairs();\n\n              if (response.data.success) {\n                let pairsArray = response.data.idNamePairs;\n                storeReducer({\n                  type: GlobalStoreActionType.CHANGE_LIST_NAME,\n                  payload: {\n                    idNamePairs: pairsArray,\n                    playlist: playlist\n                  }\n                });\n              }\n            }\n\n            getListPairs(playlist);\n          }\n        }\n\n        updateList(playlist);\n      }\n    }\n\n    asyncChangeListName(id);\n  }; //THIS FUNCTION PROCESSES CREATING A NEW LIST\n\n\n  store.createNewList = function () {\n    async function asyncCreateNewList() {\n      const name = \"Untitled\";\n      const songs = [];\n      const payload = {\n        name,\n        songs\n      };\n      let response = await api.createPlaylist(payload);\n\n      if (response.data.success) {\n        let playlist = response.data.playlist;\n\n        if (response.data.success) {\n          storeReducer({\n            type: GlobalStoreActionType.CREATE_NEW_LIST,\n            payload: playlist\n          });\n          store.history.push(\"/playlist/\" + playlist._id);\n        }\n      }\n    }\n\n    asyncCreateNewList();\n  }; //THESE FUNCTIONS ARE FOR EDITING A SONG WITH THE EDIT-SONG MODAL INCLUDED\n\n\n  store.editSong = function (title, artist, id, index) {\n    store.currentList.songs.splice(index, 1, {\n      \"title\": title,\n      \"artist\": artist,\n      \"youTubeId\": id\n    });\n    let list = store.currentList;\n\n    async function updateList2(list) {\n      let response = await api.updatePlaylistById(list._id, list);\n\n      if (response.data.success) {\n        storeReducer({\n          type: GlobalStoreActionType.SET_CURRENT_LIST,\n          payload: list\n        });\n        store.history.push(\"/playlist/\" + list._id);\n      }\n    }\n\n    updateList2(list);\n  };\n\n  store.markSongForEdit = function (song, index) {\n    document.getElementById(\"Title\").value = song.title;\n    document.getElementById(\"Artist\").value = song.artist;\n    document.getElementById(\"Id\").value = song.youTubeId;\n    storeReducer({\n      type: GlobalStoreActionType.MARK_SONG_FOR_EDIT,\n      payload: song,\n      index: index\n    });\n    store.showEditSongModal();\n  };\n\n  store.showEditSongModal = function () {\n    let modal = document.getElementById(\"edit-song-modal\");\n    modal.classList.add(\"is-visible\");\n  };\n\n  store.hideEditSongModal = function () {\n    let modal = document.getElementById(\"edit-song-modal\");\n    modal.classList.remove(\"is-visible\");\n  };\n\n  store.editSongTransaction = function () {\n    let newTitle = document.getElementById(\"Title\").value;\n    let newArtist = document.getElementById(\"Artist\").value;\n    let newYouTubeId = document.getElementById(\"Id\").value; //getting old song values\n\n    let oldTitle = store.songToEdit.title;\n    let oldArtist = store.songToEdit.artist;\n    let oldYouTubeId = store.songToEdit.youTubeId;\n    let transaction = new EditSong_Transaction(store, oldTitle, oldArtist, oldYouTubeId, newTitle, newArtist, newYouTubeId, store.indexOfSong);\n    tps.addTransaction(transaction);\n    store.hideEditSongModal(); // store.currentList.songs.splice(store.indexOfSong, 1, { \"title\": newTitle, \"artist\": newArtist, \"youTubeId\": newYouTubeId })\n    // let list = store.currentList\n    // async function updateList2(list) {\n    //     let response = await api.updatePlaylistById(list._id, list);\n    //     if (response.data.success) {\n    //         storeReducer({\n    //             type: GlobalStoreActionType.SET_CURRENT_LIST,\n    //             payload: list\n    //         });\n    //         store.history.push(\"/playlist/\" + list._id);\n    //     }\n    // }\n    // updateList2(list);\n    // store.hideEditSongModal();\n  }; //---------------------------------------------->\n  //THESE FUNCTIONS ARE FOR DELETING A SONG WITH THE DELETE-SONG MODAL INCLUDED\n\n\n  store.markSongForDelete = function (song, index) {\n    storeReducer({\n      type: GlobalStoreActionType.MARK_SONG_FOR_EDIT,\n      payload: song,\n      index: index\n    });\n    store.showDeleteSongModal();\n  };\n\n  store.showDeleteSongModal = function () {\n    let modal = document.getElementById(\"delete-song-modal\");\n    modal.classList.add(\"is-visible\");\n  };\n\n  store.hideDeleteSongModal = function () {\n    let modal = document.getElementById(\"delete-song-modal\");\n    modal.classList.remove(\"is-visible\");\n  };\n\n  store.deleteMarkedSong = function () {\n    console.log(\"Index below is\");\n    console.log(store.indexOfSong);\n    console.log(\"Before Splicing below\");\n    console.log(store.currentList.songs);\n    store.currentList.songs.splice(store.indexOfSong, 1);\n    console.log(\"After splicing\");\n    console.log(store.currentList.songs);\n    let list = store.currentList;\n\n    async function updateList3(list) {\n      let response = await api.updatePlaylistById(list._id, list);\n\n      if (response.data.success) {\n        storeReducer({\n          type: GlobalStoreActionType.SET_CURRENT_LIST,\n          payload: list\n        });\n        store.history.push(\"/playlist/\" + list._id);\n      }\n    }\n\n    updateList3(list);\n    store.hideDeleteSongModal();\n  };\n\n  store.deleteSongTransaction = function () {\n    let transaction = new DeleteSong_Transaction(store, store.songToEdit, index);\n    tps.addTransaction(transaction);\n  }; //---------------------------------------->END OF ALL DELETE SONG FUNCTIONS \n  //THESE FUNCTIONS ARE FOR DELETING A LIST WITH THE DELETE MODAL INCLUDED\n\n\n  store.showDeleteListModal = function () {\n    let modal = document.getElementById(\"delete-modal\");\n    modal.classList.add(\"is-visible\");\n  };\n\n  store.hideDeleteListModal = function () {\n    let modal = document.getElementById(\"delete-modal\");\n    modal.classList.remove(\"is-visible\");\n  };\n\n  store.markListForDeletion = function (id) {\n    async function asyncSetDeleteList(id) {\n      let response = await api.getPlaylistById(id);\n\n      if (response.data.success) {\n        let playlist = response.data.playlist;\n\n        if (response.data.success) {\n          storeReducer({\n            type: GlobalStoreActionType.MARK_LIST_FOR_DELETION,\n            payload: playlist\n          });\n          store.showDeleteListModal();\n        }\n      }\n    }\n\n    asyncSetDeleteList(id);\n  };\n\n  store.deleteMarkedList = function () {\n    store.deleteCurrentList(store.listMarkedForDeletion);\n    store.hideDeleteListModal();\n  }; //THIS FUNCTION DELETES THE CURRENT LIST\n\n\n  store.deleteCurrentList = function (id) {\n    async function processDelete(id) {\n      console.log(id);\n      let response = await api.deletePlaylistById(id);\n\n      if (response.data.success) {\n        store.loadIdNamePairs();\n        store.history.push(\"/\");\n      }\n    }\n\n    processDelete(id);\n  }; //---------------------------------->END OF ALL DELETE LIST FUNCTIONS\n  //THIS FUNCTION IS THE TRANSACTION FOR ADDING SONGS TO CURRENT LIST\n\n\n  store.addSongTransaction = function () {\n    let transaction = new AddSong_Transaction(store);\n    tps.addTransaction(transaction);\n  }; //THIS FUNCTION ADDS SONG TO CURRENT PLAYLIST\n\n\n  store.addSongToCurrentList = function () {\n    async function asyncAddSong() {\n      let id = store.currentList._id;\n      let song = {\n        \"title\": \"Untitled\",\n        \"artist\": \"Unknown\",\n        \"youTubeId\": \"dQw4w9WgXcQ\"\n      };\n      store.currentList.songs.push({\n        \"title\": \"Untitled\",\n        \"artist\": \"Unknown\",\n        \"youTubeId\": \"dQw4w9WgXcQ\"\n      });\n      let response = await api.addSongById(id, store.currentList);\n\n      if (response.data.success) {\n        storeReducer({\n          type: GlobalStoreActionType.SET_CURRENT_LIST,\n          payload: store.currentList\n        });\n        store.history.push(\"/playlist/\" + id);\n      }\n    }\n\n    asyncAddSong();\n  };\n\n  store.deleteLastSong = function () {\n    async function asyncRemoveSong() {\n      let id = store.currentList._id;\n      store.currentList.songs.pop();\n      let response = await api.addSongById(id, store.currentList);\n\n      if (response.data.success) {\n        storeReducer({\n          type: GlobalStoreActionType.SET_CURRENT_LIST,\n          payload: store.currentList\n        });\n        store.history.push(\"/playlist/\" + id);\n      }\n    }\n\n    asyncRemoveSong();\n  }; //---------------------------------->END OF ALL ADD SONG CARDS TRANSACTIONS\n  //THIS FUNCTION IS THE TRANSACTION FOR DRAG AND DROP OF SONG CARDS\n\n\n  store.addMoveSongTransaction = function (start, end) {\n    let transaction = new MoveSong_Transaction(store, start, end);\n    tps.addTransaction(transaction);\n  };\n\n  store.moveSong = function (start, end) {\n    let list = store.currentList;\n    let temp = list.songs[start];\n    list.songs[start] = list.songs[end];\n    list.songs[end] = temp;\n    store.currentList = list;\n    storeReducer({\n      type: GlobalStoreActionType.SET_CURRENT_LIST,\n      payload: store.currentList\n    });\n    store.history.push(\"/playlist/\" + store.currentList._id);\n  }; //---------------------------------->END OF ALL DRAG AND DROP SONG CARDS TRANSACTIONS\n  // THIS FUNCTION PROCESSES CLOSING THE CURRENTLY LOADED LIST\n\n\n  store.closeCurrentList = function () {\n    storeReducer({\n      type: GlobalStoreActionType.CLOSE_CURRENT_LIST,\n      payload: {}\n    });\n  }; // THIS FUNCTION LOADS ALL THE ID, NAME PAIRS SO WE CAN LIST ALL THE LISTS\n\n\n  store.loadIdNamePairs = function () {\n    async function asyncLoadIdNamePairs() {\n      const response = await api.getPlaylistPairs();\n\n      if (response.data.success) {\n        let pairsArray = response.data.idNamePairs;\n        storeReducer({\n          type: GlobalStoreActionType.LOAD_ID_NAME_PAIRS,\n          payload: pairsArray\n        });\n      } else {\n        console.log(\"API FAILED TO GET THE LIST PAIRS\");\n      }\n    }\n\n    asyncLoadIdNamePairs();\n  };\n\n  store.setCurrentList = function (id) {\n    async function asyncSetCurrentList(id) {\n      let response = await api.getPlaylistById(id);\n\n      if (response.data.success) {\n        let playlist = response.data.playlist;\n\n        if (response.data.success) {\n          storeReducer({\n            type: GlobalStoreActionType.SET_CURRENT_LIST,\n            payload: playlist\n          });\n          store.history.push(\"/playlist/\" + playlist._id);\n        }\n      }\n    }\n\n    asyncSetCurrentList(id);\n  };\n\n  store.getPlaylistSize = function () {\n    return store.currentList.songs.length;\n  };\n\n  store.undo = function () {\n    tps.undoTransaction();\n  };\n\n  store.redo = function () {\n    tps.doTransaction();\n  }; // THIS FUNCTION ENABLES THE PROCESS OF EDITING A LIST NAME\n\n\n  store.setlistNameActive = function () {\n    storeReducer({\n      type: GlobalStoreActionType.SET_LIST_NAME_EDIT_ACTIVE,\n      payload: null\n    });\n  }; // THIS GIVES OUR STORE AND ITS REDUCER TO ANY COMPONENT THAT NEEDS IT\n\n\n  return {\n    store,\n    storeReducer\n  };\n};\n\n_s(useGlobalStore, \"+Z1EgNdmw/NRU4RDzCslyjWgZA8=\");","map":{"version":3,"names":["createContext","StrictMode","useState","jsTPS","api","MoveSong_Transaction","AddSong_Transaction","EditSong_Transaction","GlobalStoreContext","GlobalStoreActionType","CHANGE_LIST_NAME","CLOSE_CURRENT_LIST","CREATE_NEW_LIST","LOAD_ID_NAME_PAIRS","SET_CURRENT_LIST","SET_LIST_NAME_EDIT_ACTIVE","MARK_SONG_FOR_EDIT","tps","useGlobalStore","store","setStore","idNamePairs","currentList","newListCounter","listNameActive","listMarkedForDeletion","nameOfDeletedList","songToEdit","indexOfSong","storeReducer","action","type","payload","index","playlist","MARK_LIST_FOR_DELETION","_id","name","changeListName","id","newName","asyncChangeListName","response","getPlaylistById","data","success","updateList","updatePlaylistById","getListPairs","getPlaylistPairs","pairsArray","createNewList","asyncCreateNewList","songs","createPlaylist","history","push","editSong","title","artist","splice","list","updateList2","markSongForEdit","song","document","getElementById","value","youTubeId","showEditSongModal","modal","classList","add","hideEditSongModal","remove","editSongTransaction","newTitle","newArtist","newYouTubeId","oldTitle","oldArtist","oldYouTubeId","transaction","addTransaction","markSongForDelete","showDeleteSongModal","hideDeleteSongModal","deleteMarkedSong","console","log","updateList3","deleteSongTransaction","DeleteSong_Transaction","showDeleteListModal","hideDeleteListModal","markListForDeletion","asyncSetDeleteList","deleteMarkedList","deleteCurrentList","processDelete","deletePlaylistById","loadIdNamePairs","addSongTransaction","addSongToCurrentList","asyncAddSong","addSongById","deleteLastSong","asyncRemoveSong","pop","addMoveSongTransaction","start","end","moveSong","temp","closeCurrentList","asyncLoadIdNamePairs","setCurrentList","asyncSetCurrentList","getPlaylistSize","length","undo","undoTransaction","redo","doTransaction","setlistNameActive"],"sources":["C:/Users/nross/Desktop/Playlister_HW3/Playlister_HW3/client/src/store/index.js"],"sourcesContent":["import { createContext, StrictMode, useState } from 'react'\nimport jsTPS from '../common/jsTPS'\nimport api from '../api'\nimport MoveSong_Transaction from '../transactions/MoveSong_Transaction'\nimport AddSong_Transaction from '../transactions/AddSong_Transaction';\nimport EditSong_Transaction from '../transactions/EditSong_Transaction';\nexport const GlobalStoreContext = createContext({});\n/*\n    This is our global data store. Note that it uses the Flux design pattern,\n    which makes use of things like actions and reducers. \n    \n    @author McKilla Gorilla ------------------> DATA STORE MAINTAINS STATES OF THE APPLICATION\n    AWAIT -> \n    API.FUNCTION(updatePlaylistById) THAT IS THE CLIENT SIDE API WHICH GENERATES MESSAGES TO SEND TO THE BKEND\n    Send a request over to the server and await wants the code to sit there and wait for a response it can only be used if the method youre calling returns something like a PROMISE \n    PROMISE is a JS Object, if a function returns a promise we can AWAIT until its compoletely done(it will do it or tell you it failed)\n    AWAIT basically will wait for that response\n    WHEN YOU WANT TO SEND MESSAGES TO THE SERVER YOU HAVE TO WAIT, YOU DONT WANT THE CODE TO JUST GO\n    IN JS THERE ARE ASYNC FUNCTION MEANS DONT WAIT FOR ME\n    ASYNC means that code can be run in a seperate thread while the code keeps going\n    the only time we call await to send a http req to the server\n    the reason we call await in async function is so you can wait on another thread and not the main thread\n    *this is **FLUX ARCHIECTURE** USED FOR UI LIBRARIES\n    REDUCER IS AN ABSTRACT STATE UPDATE, it just returns a new state and you use that to update the state\n    useCONtext allows the store to be shared with all react components\n    Hooks let us avoid using lifecycle functions\n    useState allows use to create a state? maybe idk\n    use in the frontend is a hook function\n    Reducer is purely functional prog, you give it an intial state and action and it will produce a new state, and abstract of updating the state\n    reducer is usually called by a dispatch method\n    reducer is good to know and used in many apis\n    redux api would define reducer\n    there is a useReducer hook, were not using useReducer \n    useEffect(another hook function)    \n    ROUTER BACKEND IS REALLY MIDDLEWEAR AND the router deciders if a function is like thst send it so the handler\n    FRONT END ROUTER IS ABOUT SELECTING WHICH REACT COMPONENETS SHOULD BE USED\n    2 ways to get to ROUTE\n    1. we might have a link, react router link(link object or dynamic link)\n    2. GET THE useHistory HOOK, AND PUSH YOU TO ANOTHER LIKE(YOU WILL SEE IT DONE THIS WAY)\n    run the program comment out that line see what happens, uncomment and see what happens youll see a difference \n    \n*/\n\n// THESE ARE ALL THE TYPES OF UPDATES TO OUR GLOBAL\n// DATA STORE STATE THAT CAN BE PROCESSED\nexport const GlobalStoreActionType = {\n    CHANGE_LIST_NAME: \"CHANGE_LIST_NAME\",\n    CLOSE_CURRENT_LIST: \"CLOSE_CURRENT_LIST\",\n    CREATE_NEW_LIST: \"CREATE_NEW_LIST\",\n    LOAD_ID_NAME_PAIRS: \"LOAD_ID_NAME_PAIRS\",\n    SET_CURRENT_LIST: \"SET_CURRENT_LIST\",\n    SET_LIST_NAME_EDIT_ACTIVE: \"SET_LIST_NAME_EDIT_ACTIVE\",\n    MARK_SONG_FOR_EDIT: \"MARK_SONG_FOR_EDIT\"\n}\n\n// WE'LL NEED THIS TO PROCESS TRANSACTIONS\nconst tps = new jsTPS();\n\n// WITH THIS WE'RE MAKING OUR GLOBAL DATA STORE\n// AVAILABLE TO THE REST OF THE APPLICATION\nexport const useGlobalStore = () => {\n    // THESE ARE ALL THE THINGS OUR DATA STORE WILL MANAGE\n    const [store, setStore] = useState({\n        idNamePairs: [],\n        currentList: null,\n        newListCounter: 0,\n        listNameActive: false,\n        listMarkedForDeletion: null,\n        nameOfDeletedList: null,\n        songToEdit: null,\n        indexOfSong: null\n    });\n\n    // HERE'S THE DATA STORE'S REDUCER, IT MUST\n    // HANDLE EVERY TYPE OF STATE CHANGE\n    const storeReducer = (action) => {\n        const { type, payload, index } = action;\n        switch (type) {\n            // LIST UPDATE OF ITS NAME\n            case GlobalStoreActionType.CHANGE_LIST_NAME: {\n                return setStore({\n                    idNamePairs: payload.idNamePairs,\n                    currentList: payload.playlist,\n                    newListCounter: store.newListCounter,\n                    listNameActive: false,\n                    listMarkedForDeletion: null\n                });\n            }\n\n            // STOP EDITING THE CURRENT LIST\n            case GlobalStoreActionType.CLOSE_CURRENT_LIST: {\n                return setStore({\n                    idNamePairs: store.idNamePairs,\n                    currentList: null,\n                    newListCounter: store.newListCounter,\n                    listNameActive: false,\n                    listMarkedForDeletion: null,\n                    nameOfDeletedList: null,\n                    songToEdit: null\n                })\n            }\n            // CREATE A NEW LIST\n            case GlobalStoreActionType.CREATE_NEW_LIST: {\n                return setStore({\n                    idNamePairs: store.idNamePairs,\n                    currentList: payload,\n                    newListCounter: store.newListCounter + 1,\n                    listNameActive: false,\n                    listMarkedForDeletion: null\n                })\n            }\n            // GET ALL THE LISTS SO WE CAN PRESENT THEM\n            case GlobalStoreActionType.LOAD_ID_NAME_PAIRS: {\n                return setStore({\n                    idNamePairs: payload,\n                    currentList: null,\n                    newListCounter: store.newListCounter,\n                    listNameActive: false,\n                    listMarkedForDeletion: null\n                });\n            }\n            // PREPARE TO DELETE A LIST\n            case GlobalStoreActionType.MARK_LIST_FOR_DELETION: {\n                return setStore({\n                    idNamePairs: store.idNamePairs,\n                    currentList: null,\n                    newListCounter: store.newListCounter,\n                    listNameActive: false,\n                    listMarkedForDeletion: payload._id,\n                    nameOfDeletedList: payload.name\n                });\n            }\n            //PREPARE TO EDIT SONG\n            case GlobalStoreActionType.MARK_SONG_FOR_EDIT: {\n                return setStore({\n                    idNamePairs: store.idNamePairs,\n                    currentList: store.currentList,\n                    newListCounter: store.newListCounter,\n                    listNameActive: false,\n                    listMarkedForDeletion: null,\n                    nameOfDeletedList: null,\n                    songToEdit: payload,\n                    indexOfSong: index\n                });\n            }\n            // UPDATE A LIST\n            case GlobalStoreActionType.SET_CURRENT_LIST: {\n                return setStore({\n                    idNamePairs: store.idNamePairs,\n                    currentList: payload,\n                    newListCounter: store.newListCounter,\n                    listNameActive: false,\n                    listMarkedForDeletion: null\n                });\n            }\n            // START EDITING A LIST NAME\n            case GlobalStoreActionType.SET_LIST_NAME_EDIT_ACTIVE: {\n                return setStore({\n                    idNamePairs: store.idNamePairs,\n                    currentList: payload,\n                    newListCounter: store.newListCounter,\n                    listNameActive: true,\n                    listMarkedForDeletion: null\n                });\n            }\n            default:\n                return store;\n        }\n    }\n    // THESE ARE THE FUNCTIONS THAT WILL UPDATE OUR STORE AND\n    // DRIVE THE STATE OF THE APPLICATION. WE'LL CALL THESE IN \n    // RESPONSE TO EVENTS INSIDE OUR COMPONENTS.\n\n    // THIS FUNCTION PROCESSES CHANGING A LIST NAME\n    store.changeListName = function (id, newName) {\n        // GET THE LIST\n        async function asyncChangeListName(id) {\n            let response = await api.getPlaylistById(id);\n            if (response.data.success) {\n                let playlist = response.data.playlist; //bruh playlist was spelled wrong\n                //console.log(playlist);\n                playlist.name = newName;\n                async function updateList(playlist) {\n                    response = await api.updatePlaylistById(playlist._id, playlist);\n                    if (response.data.success) {\n                        async function getListPairs(playlist) {\n                            response = await api.getPlaylistPairs();\n                            if (response.data.success) {\n                                let pairsArray = response.data.idNamePairs;\n                                storeReducer({\n                                    type: GlobalStoreActionType.CHANGE_LIST_NAME,\n                                    payload: {\n                                        idNamePairs: pairsArray,\n                                        playlist: playlist\n                                    }\n                                });\n                            }\n                        }\n                        getListPairs(playlist);\n                    }\n                }\n                updateList(playlist);\n            }\n        }\n        asyncChangeListName(id);\n    }\n\n    //THIS FUNCTION PROCESSES CREATING A NEW LIST\n    store.createNewList = function () {\n        async function asyncCreateNewList() {\n            const name = \"Untitled\"\n            const songs = []\n            const payload = { name, songs }\n\n            let response = await api.createPlaylist(payload);\n            if (response.data.success) {\n                let playlist = response.data.playlist;\n\n                if (response.data.success) {\n                    storeReducer({\n                        type: GlobalStoreActionType.CREATE_NEW_LIST,\n                        payload: playlist\n                    });\n                    store.history.push(\"/playlist/\" + playlist._id);\n                }\n            }\n        }\n        asyncCreateNewList();\n    }\n\n    //THESE FUNCTIONS ARE FOR EDITING A SONG WITH THE EDIT-SONG MODAL INCLUDED\n    store.editSong = function (title, artist, id, index) {\n        store.currentList.songs.splice(index, 1, { \"title\": title, \"artist\": artist, \"youTubeId\": id })\n        let list = store.currentList\n        async function updateList2(list) {\n            let response = await api.updatePlaylistById(list._id, list);\n            if (response.data.success) {\n                storeReducer({\n                    type: GlobalStoreActionType.SET_CURRENT_LIST,\n                    payload: list\n                });\n                store.history.push(\"/playlist/\" + list._id);\n            }\n        }\n        updateList2(list);\n    }\n    store.markSongForEdit = function (song, index) {\n        document.getElementById(\"Title\").value = song.title\n        document.getElementById(\"Artist\").value = song.artist\n        document.getElementById(\"Id\").value = song.youTubeId\n        storeReducer({\n            type: GlobalStoreActionType.MARK_SONG_FOR_EDIT,\n            payload: song,\n            index: index\n        });\n        store.showEditSongModal();\n    }\n    store.showEditSongModal = function () {\n        let modal = document.getElementById(\"edit-song-modal\");\n        modal.classList.add(\"is-visible\");\n    }\n    store.hideEditSongModal = function () {\n        let modal = document.getElementById(\"edit-song-modal\");\n        modal.classList.remove(\"is-visible\");\n    }\n    store.editSongTransaction = function () {\n        let newTitle = document.getElementById(\"Title\").value\n        let newArtist = document.getElementById(\"Artist\").value\n        let newYouTubeId = document.getElementById(\"Id\").value\n        //getting old song values\n        let oldTitle = store.songToEdit.title\n        let oldArtist = store.songToEdit.artist\n        let oldYouTubeId = store.songToEdit.youTubeId\n\n        let transaction = new EditSong_Transaction(store, oldTitle, oldArtist, oldYouTubeId, newTitle, newArtist, newYouTubeId, store.indexOfSong);\n        tps.addTransaction(transaction);\n        store.hideEditSongModal();\n        // store.currentList.songs.splice(store.indexOfSong, 1, { \"title\": newTitle, \"artist\": newArtist, \"youTubeId\": newYouTubeId })\n        // let list = store.currentList\n        // async function updateList2(list) {\n        //     let response = await api.updatePlaylistById(list._id, list);\n        //     if (response.data.success) {\n        //         storeReducer({\n        //             type: GlobalStoreActionType.SET_CURRENT_LIST,\n        //             payload: list\n        //         });\n        //         store.history.push(\"/playlist/\" + list._id);\n        //     }\n        // }\n        // updateList2(list);\n        // store.hideEditSongModal();\n    }\n    //---------------------------------------------->\n\n    //THESE FUNCTIONS ARE FOR DELETING A SONG WITH THE DELETE-SONG MODAL INCLUDED\n    store.markSongForDelete = function (song, index) {\n        storeReducer({\n            type: GlobalStoreActionType.MARK_SONG_FOR_EDIT,\n            payload: song,\n            index: index\n        });\n        store.showDeleteSongModal();\n    }\n    store.showDeleteSongModal = function () {\n        let modal = document.getElementById(\"delete-song-modal\");\n        modal.classList.add(\"is-visible\");\n    }\n    store.hideDeleteSongModal = function () {\n        let modal = document.getElementById(\"delete-song-modal\");\n        modal.classList.remove(\"is-visible\");\n    }\n    store.deleteMarkedSong = function () {\n        console.log(\"Index below is\")\n        console.log(store.indexOfSong)\n        console.log(\"Before Splicing below\")\n        console.log(store.currentList.songs)\n        store.currentList.songs.splice(store.indexOfSong, 1)\n        console.log(\"After splicing\")\n        console.log(store.currentList.songs)\n        let list = store.currentList\n        async function updateList3(list) {\n            let response = await api.updatePlaylistById(list._id, list);\n            if (response.data.success) {\n                storeReducer({\n                    type: GlobalStoreActionType.SET_CURRENT_LIST,\n                    payload: list\n                });\n                store.history.push(\"/playlist/\" + list._id);\n            }\n        }\n        updateList3(list);\n        store.hideDeleteSongModal();\n    }\n    store.deleteSongTransaction = function () {\n        let transaction = new DeleteSong_Transaction(store, store.songToEdit, index);\n        tps.addTransaction(transaction);\n    }\n    //---------------------------------------->END OF ALL DELETE SONG FUNCTIONS \n\n    //THESE FUNCTIONS ARE FOR DELETING A LIST WITH THE DELETE MODAL INCLUDED\n    store.showDeleteListModal = function () {\n        let modal = document.getElementById(\"delete-modal\");\n        modal.classList.add(\"is-visible\");\n    }\n    store.hideDeleteListModal = function () {\n        let modal = document.getElementById(\"delete-modal\");\n        modal.classList.remove(\"is-visible\");\n    }\n    store.markListForDeletion = function (id) {\n        async function asyncSetDeleteList(id) {\n            let response = await api.getPlaylistById(id);\n            if (response.data.success) {\n                let playlist = response.data.playlist;\n                if (response.data.success) {\n                    storeReducer({\n                        type: GlobalStoreActionType.MARK_LIST_FOR_DELETION,\n                        payload: playlist\n                    });\n                    store.showDeleteListModal();\n                }\n            }\n        }\n        asyncSetDeleteList(id);\n    }\n    store.deleteMarkedList = function () {\n        store.deleteCurrentList(store.listMarkedForDeletion);\n        store.hideDeleteListModal();\n    }\n    //THIS FUNCTION DELETES THE CURRENT LIST\n    store.deleteCurrentList = function (id) {\n        async function processDelete(id) {\n            console.log(id);\n            let response = await api.deletePlaylistById(id);\n            if (response.data.success) {\n                store.loadIdNamePairs();\n                store.history.push(\"/\");\n            }\n        }\n        processDelete(id);\n    }\n    //---------------------------------->END OF ALL DELETE LIST FUNCTIONS\n\n    //THIS FUNCTION IS THE TRANSACTION FOR ADDING SONGS TO CURRENT LIST\n    store.addSongTransaction = function () {\n        let transaction = new AddSong_Transaction(store);\n        tps.addTransaction(transaction);\n    }\n    //THIS FUNCTION ADDS SONG TO CURRENT PLAYLIST\n    store.addSongToCurrentList = function () {\n        async function asyncAddSong() {\n            let id = store.currentList._id;\n            let song = { \"title\": \"Untitled\", \"artist\": \"Unknown\", \"youTubeId\": \"dQw4w9WgXcQ\" };\n            store.currentList.songs.push({ \"title\": \"Untitled\", \"artist\": \"Unknown\", \"youTubeId\": \"dQw4w9WgXcQ\" });\n            let response = await api.addSongById(id, store.currentList);\n            if (response.data.success) {\n                storeReducer({\n                    type: GlobalStoreActionType.SET_CURRENT_LIST,\n                    payload: store.currentList\n                });\n                store.history.push(\"/playlist/\" + id);\n            }\n        }\n        asyncAddSong();\n    }\n    store.deleteLastSong = function () {\n        async function asyncRemoveSong() {\n            let id = store.currentList._id;\n            store.currentList.songs.pop()\n            let response = await api.addSongById(id, store.currentList);\n            if (response.data.success) {\n                storeReducer({\n                    type: GlobalStoreActionType.SET_CURRENT_LIST,\n                    payload: store.currentList\n                });\n                store.history.push(\"/playlist/\" + id);\n            }\n        }\n        asyncRemoveSong();\n    }\n    //---------------------------------->END OF ALL ADD SONG CARDS TRANSACTIONS\n\n    //THIS FUNCTION IS THE TRANSACTION FOR DRAG AND DROP OF SONG CARDS\n    store.addMoveSongTransaction = function (start, end) {\n        let transaction = new MoveSong_Transaction(store, start, end);\n        tps.addTransaction(transaction);\n    }\n    store.moveSong = function (start, end) {\n        let list = store.currentList;\n\n        let temp = list.songs[start];\n        list.songs[start] = list.songs[end];\n        list.songs[end] = temp;\n\n        store.currentList = list\n        storeReducer({\n            type: GlobalStoreActionType.SET_CURRENT_LIST,\n            payload: store.currentList\n        });\n        store.history.push(\"/playlist/\" + store.currentList._id);\n    }\n    //---------------------------------->END OF ALL DRAG AND DROP SONG CARDS TRANSACTIONS\n\n\n\n    // THIS FUNCTION PROCESSES CLOSING THE CURRENTLY LOADED LIST\n    store.closeCurrentList = function () {\n        storeReducer({\n            type: GlobalStoreActionType.CLOSE_CURRENT_LIST,\n            payload: {}\n        });\n    }\n    // THIS FUNCTION LOADS ALL THE ID, NAME PAIRS SO WE CAN LIST ALL THE LISTS\n    store.loadIdNamePairs = function () {\n        async function asyncLoadIdNamePairs() {\n            const response = await api.getPlaylistPairs();\n            if (response.data.success) {\n                let pairsArray = response.data.idNamePairs;\n                storeReducer({\n                    type: GlobalStoreActionType.LOAD_ID_NAME_PAIRS,\n                    payload: pairsArray\n                });\n            }\n            else {\n                console.log(\"API FAILED TO GET THE LIST PAIRS\");\n            }\n        }\n        asyncLoadIdNamePairs();\n    }\n    store.setCurrentList = function (id) {\n        async function asyncSetCurrentList(id) {\n            let response = await api.getPlaylistById(id);\n            if (response.data.success) {\n                let playlist = response.data.playlist;\n\n                if (response.data.success) {\n                    storeReducer({\n                        type: GlobalStoreActionType.SET_CURRENT_LIST,\n                        payload: playlist\n                    });\n                    store.history.push(\"/playlist/\" + playlist._id);\n                }\n            }\n        }\n        asyncSetCurrentList(id);\n    }\n    store.getPlaylistSize = function () {\n        return store.currentList.songs.length;\n    }\n    store.undo = function () {\n        tps.undoTransaction();\n    }\n    store.redo = function () {\n        tps.doTransaction();\n    }\n\n    // THIS FUNCTION ENABLES THE PROCESS OF EDITING A LIST NAME\n    store.setlistNameActive = function () {\n        storeReducer({\n            type: GlobalStoreActionType.SET_LIST_NAME_EDIT_ACTIVE,\n            payload: null\n        });\n    }\n\n    // THIS GIVES OUR STORE AND ITS REDUCER TO ANY COMPONENT THAT NEEDS IT\n    return { store, storeReducer };\n}"],"mappings":";;AAAA,SAASA,aAAT,EAAwBC,UAAxB,EAAoCC,QAApC,QAAoD,OAApD;AACA,OAAOC,KAAP,MAAkB,iBAAlB;AACA,OAAOC,GAAP,MAAgB,QAAhB;AACA,OAAOC,oBAAP,MAAiC,sCAAjC;AACA,OAAOC,mBAAP,MAAgC,qCAAhC;AACA,OAAOC,oBAAP,MAAiC,sCAAjC;AACA,OAAO,MAAMC,kBAAkB,gBAAGR,aAAa,CAAC,EAAD,CAAxC;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;AACA,OAAO,MAAMS,qBAAqB,GAAG;EACjCC,gBAAgB,EAAE,kBADe;EAEjCC,kBAAkB,EAAE,oBAFa;EAGjCC,eAAe,EAAE,iBAHgB;EAIjCC,kBAAkB,EAAE,oBAJa;EAKjCC,gBAAgB,EAAE,kBALe;EAMjCC,yBAAyB,EAAE,2BANM;EAOjCC,kBAAkB,EAAE;AAPa,CAA9B,C,CAUP;;AACA,MAAMC,GAAG,GAAG,IAAId,KAAJ,EAAZ,C,CAEA;AACA;;AACA,OAAO,MAAMe,cAAc,GAAG,MAAM;EAAA;;EAChC;EACA,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBlB,QAAQ,CAAC;IAC/BmB,WAAW,EAAE,EADkB;IAE/BC,WAAW,EAAE,IAFkB;IAG/BC,cAAc,EAAE,CAHe;IAI/BC,cAAc,EAAE,KAJe;IAK/BC,qBAAqB,EAAE,IALQ;IAM/BC,iBAAiB,EAAE,IANY;IAO/BC,UAAU,EAAE,IAPmB;IAQ/BC,WAAW,EAAE;EARkB,CAAD,CAAlC,CAFgC,CAahC;EACA;;EACA,MAAMC,YAAY,GAAIC,MAAD,IAAY;IAC7B,MAAM;MAAEC,IAAF;MAAQC,OAAR;MAAiBC;IAAjB,IAA2BH,MAAjC;;IACA,QAAQC,IAAR;MACI;MACA,KAAKtB,qBAAqB,CAACC,gBAA3B;QAA6C;UACzC,OAAOU,QAAQ,CAAC;YACZC,WAAW,EAAEW,OAAO,CAACX,WADT;YAEZC,WAAW,EAAEU,OAAO,CAACE,QAFT;YAGZX,cAAc,EAAEJ,KAAK,CAACI,cAHV;YAIZC,cAAc,EAAE,KAJJ;YAKZC,qBAAqB,EAAE;UALX,CAAD,CAAf;QAOH;MAED;;MACA,KAAKhB,qBAAqB,CAACE,kBAA3B;QAA+C;UAC3C,OAAOS,QAAQ,CAAC;YACZC,WAAW,EAAEF,KAAK,CAACE,WADP;YAEZC,WAAW,EAAE,IAFD;YAGZC,cAAc,EAAEJ,KAAK,CAACI,cAHV;YAIZC,cAAc,EAAE,KAJJ;YAKZC,qBAAqB,EAAE,IALX;YAMZC,iBAAiB,EAAE,IANP;YAOZC,UAAU,EAAE;UAPA,CAAD,CAAf;QASH;MACD;;MACA,KAAKlB,qBAAqB,CAACG,eAA3B;QAA4C;UACxC,OAAOQ,QAAQ,CAAC;YACZC,WAAW,EAAEF,KAAK,CAACE,WADP;YAEZC,WAAW,EAAEU,OAFD;YAGZT,cAAc,EAAEJ,KAAK,CAACI,cAAN,GAAuB,CAH3B;YAIZC,cAAc,EAAE,KAJJ;YAKZC,qBAAqB,EAAE;UALX,CAAD,CAAf;QAOH;MACD;;MACA,KAAKhB,qBAAqB,CAACI,kBAA3B;QAA+C;UAC3C,OAAOO,QAAQ,CAAC;YACZC,WAAW,EAAEW,OADD;YAEZV,WAAW,EAAE,IAFD;YAGZC,cAAc,EAAEJ,KAAK,CAACI,cAHV;YAIZC,cAAc,EAAE,KAJJ;YAKZC,qBAAqB,EAAE;UALX,CAAD,CAAf;QAOH;MACD;;MACA,KAAKhB,qBAAqB,CAAC0B,sBAA3B;QAAmD;UAC/C,OAAOf,QAAQ,CAAC;YACZC,WAAW,EAAEF,KAAK,CAACE,WADP;YAEZC,WAAW,EAAE,IAFD;YAGZC,cAAc,EAAEJ,KAAK,CAACI,cAHV;YAIZC,cAAc,EAAE,KAJJ;YAKZC,qBAAqB,EAAEO,OAAO,CAACI,GALnB;YAMZV,iBAAiB,EAAEM,OAAO,CAACK;UANf,CAAD,CAAf;QAQH;MACD;;MACA,KAAK5B,qBAAqB,CAACO,kBAA3B;QAA+C;UAC3C,OAAOI,QAAQ,CAAC;YACZC,WAAW,EAAEF,KAAK,CAACE,WADP;YAEZC,WAAW,EAAEH,KAAK,CAACG,WAFP;YAGZC,cAAc,EAAEJ,KAAK,CAACI,cAHV;YAIZC,cAAc,EAAE,KAJJ;YAKZC,qBAAqB,EAAE,IALX;YAMZC,iBAAiB,EAAE,IANP;YAOZC,UAAU,EAAEK,OAPA;YAQZJ,WAAW,EAAEK;UARD,CAAD,CAAf;QAUH;MACD;;MACA,KAAKxB,qBAAqB,CAACK,gBAA3B;QAA6C;UACzC,OAAOM,QAAQ,CAAC;YACZC,WAAW,EAAEF,KAAK,CAACE,WADP;YAEZC,WAAW,EAAEU,OAFD;YAGZT,cAAc,EAAEJ,KAAK,CAACI,cAHV;YAIZC,cAAc,EAAE,KAJJ;YAKZC,qBAAqB,EAAE;UALX,CAAD,CAAf;QAOH;MACD;;MACA,KAAKhB,qBAAqB,CAACM,yBAA3B;QAAsD;UAClD,OAAOK,QAAQ,CAAC;YACZC,WAAW,EAAEF,KAAK,CAACE,WADP;YAEZC,WAAW,EAAEU,OAFD;YAGZT,cAAc,EAAEJ,KAAK,CAACI,cAHV;YAIZC,cAAc,EAAE,IAJJ;YAKZC,qBAAqB,EAAE;UALX,CAAD,CAAf;QAOH;;MACD;QACI,OAAON,KAAP;IAzFR;EA2FH,CA7FD,CAfgC,CA6GhC;EACA;EACA;EAEA;;;EACAA,KAAK,CAACmB,cAAN,GAAuB,UAAUC,EAAV,EAAcC,OAAd,EAAuB;IAC1C;IACA,eAAeC,mBAAf,CAAmCF,EAAnC,EAAuC;MACnC,IAAIG,QAAQ,GAAG,MAAMtC,GAAG,CAACuC,eAAJ,CAAoBJ,EAApB,CAArB;;MACA,IAAIG,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;QACvB,IAAIX,QAAQ,GAAGQ,QAAQ,CAACE,IAAT,CAAcV,QAA7B,CADuB,CACgB;QACvC;;QACAA,QAAQ,CAACG,IAAT,GAAgBG,OAAhB;;QACA,eAAeM,UAAf,CAA0BZ,QAA1B,EAAoC;UAChCQ,QAAQ,GAAG,MAAMtC,GAAG,CAAC2C,kBAAJ,CAAuBb,QAAQ,CAACE,GAAhC,EAAqCF,QAArC,CAAjB;;UACA,IAAIQ,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;YACvB,eAAeG,YAAf,CAA4Bd,QAA5B,EAAsC;cAClCQ,QAAQ,GAAG,MAAMtC,GAAG,CAAC6C,gBAAJ,EAAjB;;cACA,IAAIP,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;gBACvB,IAAIK,UAAU,GAAGR,QAAQ,CAACE,IAAT,CAAcvB,WAA/B;gBACAQ,YAAY,CAAC;kBACTE,IAAI,EAAEtB,qBAAqB,CAACC,gBADnB;kBAETsB,OAAO,EAAE;oBACLX,WAAW,EAAE6B,UADR;oBAELhB,QAAQ,EAAEA;kBAFL;gBAFA,CAAD,CAAZ;cAOH;YACJ;;YACDc,YAAY,CAACd,QAAD,CAAZ;UACH;QACJ;;QACDY,UAAU,CAACZ,QAAD,CAAV;MACH;IACJ;;IACDO,mBAAmB,CAACF,EAAD,CAAnB;EACH,CA/BD,CAlHgC,CAmJhC;;;EACApB,KAAK,CAACgC,aAAN,GAAsB,YAAY;IAC9B,eAAeC,kBAAf,GAAoC;MAChC,MAAMf,IAAI,GAAG,UAAb;MACA,MAAMgB,KAAK,GAAG,EAAd;MACA,MAAMrB,OAAO,GAAG;QAAEK,IAAF;QAAQgB;MAAR,CAAhB;MAEA,IAAIX,QAAQ,GAAG,MAAMtC,GAAG,CAACkD,cAAJ,CAAmBtB,OAAnB,CAArB;;MACA,IAAIU,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;QACvB,IAAIX,QAAQ,GAAGQ,QAAQ,CAACE,IAAT,CAAcV,QAA7B;;QAEA,IAAIQ,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;UACvBhB,YAAY,CAAC;YACTE,IAAI,EAAEtB,qBAAqB,CAACG,eADnB;YAEToB,OAAO,EAAEE;UAFA,CAAD,CAAZ;UAIAf,KAAK,CAACoC,OAAN,CAAcC,IAAd,CAAmB,eAAetB,QAAQ,CAACE,GAA3C;QACH;MACJ;IACJ;;IACDgB,kBAAkB;EACrB,CApBD,CApJgC,CA0KhC;;;EACAjC,KAAK,CAACsC,QAAN,GAAiB,UAAUC,KAAV,EAAiBC,MAAjB,EAAyBpB,EAAzB,EAA6BN,KAA7B,EAAoC;IACjDd,KAAK,CAACG,WAAN,CAAkB+B,KAAlB,CAAwBO,MAAxB,CAA+B3B,KAA/B,EAAsC,CAAtC,EAAyC;MAAE,SAASyB,KAAX;MAAkB,UAAUC,MAA5B;MAAoC,aAAapB;IAAjD,CAAzC;IACA,IAAIsB,IAAI,GAAG1C,KAAK,CAACG,WAAjB;;IACA,eAAewC,WAAf,CAA2BD,IAA3B,EAAiC;MAC7B,IAAInB,QAAQ,GAAG,MAAMtC,GAAG,CAAC2C,kBAAJ,CAAuBc,IAAI,CAACzB,GAA5B,EAAiCyB,IAAjC,CAArB;;MACA,IAAInB,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;QACvBhB,YAAY,CAAC;UACTE,IAAI,EAAEtB,qBAAqB,CAACK,gBADnB;UAETkB,OAAO,EAAE6B;QAFA,CAAD,CAAZ;QAIA1C,KAAK,CAACoC,OAAN,CAAcC,IAAd,CAAmB,eAAeK,IAAI,CAACzB,GAAvC;MACH;IACJ;;IACD0B,WAAW,CAACD,IAAD,CAAX;EACH,CAdD;;EAeA1C,KAAK,CAAC4C,eAAN,GAAwB,UAAUC,IAAV,EAAgB/B,KAAhB,EAAuB;IAC3CgC,QAAQ,CAACC,cAAT,CAAwB,OAAxB,EAAiCC,KAAjC,GAAyCH,IAAI,CAACN,KAA9C;IACAO,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCC,KAAlC,GAA0CH,IAAI,CAACL,MAA/C;IACAM,QAAQ,CAACC,cAAT,CAAwB,IAAxB,EAA8BC,KAA9B,GAAsCH,IAAI,CAACI,SAA3C;IACAvC,YAAY,CAAC;MACTE,IAAI,EAAEtB,qBAAqB,CAACO,kBADnB;MAETgB,OAAO,EAAEgC,IAFA;MAGT/B,KAAK,EAAEA;IAHE,CAAD,CAAZ;IAKAd,KAAK,CAACkD,iBAAN;EACH,CAVD;;EAWAlD,KAAK,CAACkD,iBAAN,GAA0B,YAAY;IAClC,IAAIC,KAAK,GAAGL,QAAQ,CAACC,cAAT,CAAwB,iBAAxB,CAAZ;IACAI,KAAK,CAACC,SAAN,CAAgBC,GAAhB,CAAoB,YAApB;EACH,CAHD;;EAIArD,KAAK,CAACsD,iBAAN,GAA0B,YAAY;IAClC,IAAIH,KAAK,GAAGL,QAAQ,CAACC,cAAT,CAAwB,iBAAxB,CAAZ;IACAI,KAAK,CAACC,SAAN,CAAgBG,MAAhB,CAAuB,YAAvB;EACH,CAHD;;EAIAvD,KAAK,CAACwD,mBAAN,GAA4B,YAAY;IACpC,IAAIC,QAAQ,GAAGX,QAAQ,CAACC,cAAT,CAAwB,OAAxB,EAAiCC,KAAhD;IACA,IAAIU,SAAS,GAAGZ,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCC,KAAlD;IACA,IAAIW,YAAY,GAAGb,QAAQ,CAACC,cAAT,CAAwB,IAAxB,EAA8BC,KAAjD,CAHoC,CAIpC;;IACA,IAAIY,QAAQ,GAAG5D,KAAK,CAACQ,UAAN,CAAiB+B,KAAhC;IACA,IAAIsB,SAAS,GAAG7D,KAAK,CAACQ,UAAN,CAAiBgC,MAAjC;IACA,IAAIsB,YAAY,GAAG9D,KAAK,CAACQ,UAAN,CAAiByC,SAApC;IAEA,IAAIc,WAAW,GAAG,IAAI3E,oBAAJ,CAAyBY,KAAzB,EAAgC4D,QAAhC,EAA0CC,SAA1C,EAAqDC,YAArD,EAAmEL,QAAnE,EAA6EC,SAA7E,EAAwFC,YAAxF,EAAsG3D,KAAK,CAACS,WAA5G,CAAlB;IACAX,GAAG,CAACkE,cAAJ,CAAmBD,WAAnB;IACA/D,KAAK,CAACsD,iBAAN,GAXoC,CAYpC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EACH,CA1BD,CA7MgC,CAwOhC;EAEA;;;EACAtD,KAAK,CAACiE,iBAAN,GAA0B,UAAUpB,IAAV,EAAgB/B,KAAhB,EAAuB;IAC7CJ,YAAY,CAAC;MACTE,IAAI,EAAEtB,qBAAqB,CAACO,kBADnB;MAETgB,OAAO,EAAEgC,IAFA;MAGT/B,KAAK,EAAEA;IAHE,CAAD,CAAZ;IAKAd,KAAK,CAACkE,mBAAN;EACH,CAPD;;EAQAlE,KAAK,CAACkE,mBAAN,GAA4B,YAAY;IACpC,IAAIf,KAAK,GAAGL,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,CAAZ;IACAI,KAAK,CAACC,SAAN,CAAgBC,GAAhB,CAAoB,YAApB;EACH,CAHD;;EAIArD,KAAK,CAACmE,mBAAN,GAA4B,YAAY;IACpC,IAAIhB,KAAK,GAAGL,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,CAAZ;IACAI,KAAK,CAACC,SAAN,CAAgBG,MAAhB,CAAuB,YAAvB;EACH,CAHD;;EAIAvD,KAAK,CAACoE,gBAAN,GAAyB,YAAY;IACjCC,OAAO,CAACC,GAAR,CAAY,gBAAZ;IACAD,OAAO,CAACC,GAAR,CAAYtE,KAAK,CAACS,WAAlB;IACA4D,OAAO,CAACC,GAAR,CAAY,uBAAZ;IACAD,OAAO,CAACC,GAAR,CAAYtE,KAAK,CAACG,WAAN,CAAkB+B,KAA9B;IACAlC,KAAK,CAACG,WAAN,CAAkB+B,KAAlB,CAAwBO,MAAxB,CAA+BzC,KAAK,CAACS,WAArC,EAAkD,CAAlD;IACA4D,OAAO,CAACC,GAAR,CAAY,gBAAZ;IACAD,OAAO,CAACC,GAAR,CAAYtE,KAAK,CAACG,WAAN,CAAkB+B,KAA9B;IACA,IAAIQ,IAAI,GAAG1C,KAAK,CAACG,WAAjB;;IACA,eAAeoE,WAAf,CAA2B7B,IAA3B,EAAiC;MAC7B,IAAInB,QAAQ,GAAG,MAAMtC,GAAG,CAAC2C,kBAAJ,CAAuBc,IAAI,CAACzB,GAA5B,EAAiCyB,IAAjC,CAArB;;MACA,IAAInB,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;QACvBhB,YAAY,CAAC;UACTE,IAAI,EAAEtB,qBAAqB,CAACK,gBADnB;UAETkB,OAAO,EAAE6B;QAFA,CAAD,CAAZ;QAIA1C,KAAK,CAACoC,OAAN,CAAcC,IAAd,CAAmB,eAAeK,IAAI,CAACzB,GAAvC;MACH;IACJ;;IACDsD,WAAW,CAAC7B,IAAD,CAAX;IACA1C,KAAK,CAACmE,mBAAN;EACH,CArBD;;EAsBAnE,KAAK,CAACwE,qBAAN,GAA8B,YAAY;IACtC,IAAIT,WAAW,GAAG,IAAIU,sBAAJ,CAA2BzE,KAA3B,EAAkCA,KAAK,CAACQ,UAAxC,EAAoDM,KAApD,CAAlB;IACAhB,GAAG,CAACkE,cAAJ,CAAmBD,WAAnB;EACH,CAHD,CAjRgC,CAqRhC;EAEA;;;EACA/D,KAAK,CAAC0E,mBAAN,GAA4B,YAAY;IACpC,IAAIvB,KAAK,GAAGL,QAAQ,CAACC,cAAT,CAAwB,cAAxB,CAAZ;IACAI,KAAK,CAACC,SAAN,CAAgBC,GAAhB,CAAoB,YAApB;EACH,CAHD;;EAIArD,KAAK,CAAC2E,mBAAN,GAA4B,YAAY;IACpC,IAAIxB,KAAK,GAAGL,QAAQ,CAACC,cAAT,CAAwB,cAAxB,CAAZ;IACAI,KAAK,CAACC,SAAN,CAAgBG,MAAhB,CAAuB,YAAvB;EACH,CAHD;;EAIAvD,KAAK,CAAC4E,mBAAN,GAA4B,UAAUxD,EAAV,EAAc;IACtC,eAAeyD,kBAAf,CAAkCzD,EAAlC,EAAsC;MAClC,IAAIG,QAAQ,GAAG,MAAMtC,GAAG,CAACuC,eAAJ,CAAoBJ,EAApB,CAArB;;MACA,IAAIG,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;QACvB,IAAIX,QAAQ,GAAGQ,QAAQ,CAACE,IAAT,CAAcV,QAA7B;;QACA,IAAIQ,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;UACvBhB,YAAY,CAAC;YACTE,IAAI,EAAEtB,qBAAqB,CAAC0B,sBADnB;YAETH,OAAO,EAAEE;UAFA,CAAD,CAAZ;UAIAf,KAAK,CAAC0E,mBAAN;QACH;MACJ;IACJ;;IACDG,kBAAkB,CAACzD,EAAD,CAAlB;EACH,CAfD;;EAgBApB,KAAK,CAAC8E,gBAAN,GAAyB,YAAY;IACjC9E,KAAK,CAAC+E,iBAAN,CAAwB/E,KAAK,CAACM,qBAA9B;IACAN,KAAK,CAAC2E,mBAAN;EACH,CAHD,CAhTgC,CAoThC;;;EACA3E,KAAK,CAAC+E,iBAAN,GAA0B,UAAU3D,EAAV,EAAc;IACpC,eAAe4D,aAAf,CAA6B5D,EAA7B,EAAiC;MAC7BiD,OAAO,CAACC,GAAR,CAAYlD,EAAZ;MACA,IAAIG,QAAQ,GAAG,MAAMtC,GAAG,CAACgG,kBAAJ,CAAuB7D,EAAvB,CAArB;;MACA,IAAIG,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;QACvB1B,KAAK,CAACkF,eAAN;QACAlF,KAAK,CAACoC,OAAN,CAAcC,IAAd,CAAmB,GAAnB;MACH;IACJ;;IACD2C,aAAa,CAAC5D,EAAD,CAAb;EACH,CAVD,CArTgC,CAgUhC;EAEA;;;EACApB,KAAK,CAACmF,kBAAN,GAA2B,YAAY;IACnC,IAAIpB,WAAW,GAAG,IAAI5E,mBAAJ,CAAwBa,KAAxB,CAAlB;IACAF,GAAG,CAACkE,cAAJ,CAAmBD,WAAnB;EACH,CAHD,CAnUgC,CAuUhC;;;EACA/D,KAAK,CAACoF,oBAAN,GAA6B,YAAY;IACrC,eAAeC,YAAf,GAA8B;MAC1B,IAAIjE,EAAE,GAAGpB,KAAK,CAACG,WAAN,CAAkBc,GAA3B;MACA,IAAI4B,IAAI,GAAG;QAAE,SAAS,UAAX;QAAuB,UAAU,SAAjC;QAA4C,aAAa;MAAzD,CAAX;MACA7C,KAAK,CAACG,WAAN,CAAkB+B,KAAlB,CAAwBG,IAAxB,CAA6B;QAAE,SAAS,UAAX;QAAuB,UAAU,SAAjC;QAA4C,aAAa;MAAzD,CAA7B;MACA,IAAId,QAAQ,GAAG,MAAMtC,GAAG,CAACqG,WAAJ,CAAgBlE,EAAhB,EAAoBpB,KAAK,CAACG,WAA1B,CAArB;;MACA,IAAIoB,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;QACvBhB,YAAY,CAAC;UACTE,IAAI,EAAEtB,qBAAqB,CAACK,gBADnB;UAETkB,OAAO,EAAEb,KAAK,CAACG;QAFN,CAAD,CAAZ;QAIAH,KAAK,CAACoC,OAAN,CAAcC,IAAd,CAAmB,eAAejB,EAAlC;MACH;IACJ;;IACDiE,YAAY;EACf,CAfD;;EAgBArF,KAAK,CAACuF,cAAN,GAAuB,YAAY;IAC/B,eAAeC,eAAf,GAAiC;MAC7B,IAAIpE,EAAE,GAAGpB,KAAK,CAACG,WAAN,CAAkBc,GAA3B;MACAjB,KAAK,CAACG,WAAN,CAAkB+B,KAAlB,CAAwBuD,GAAxB;MACA,IAAIlE,QAAQ,GAAG,MAAMtC,GAAG,CAACqG,WAAJ,CAAgBlE,EAAhB,EAAoBpB,KAAK,CAACG,WAA1B,CAArB;;MACA,IAAIoB,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;QACvBhB,YAAY,CAAC;UACTE,IAAI,EAAEtB,qBAAqB,CAACK,gBADnB;UAETkB,OAAO,EAAEb,KAAK,CAACG;QAFN,CAAD,CAAZ;QAIAH,KAAK,CAACoC,OAAN,CAAcC,IAAd,CAAmB,eAAejB,EAAlC;MACH;IACJ;;IACDoE,eAAe;EAClB,CAdD,CAxVgC,CAuWhC;EAEA;;;EACAxF,KAAK,CAAC0F,sBAAN,GAA+B,UAAUC,KAAV,EAAiBC,GAAjB,EAAsB;IACjD,IAAI7B,WAAW,GAAG,IAAI7E,oBAAJ,CAAyBc,KAAzB,EAAgC2F,KAAhC,EAAuCC,GAAvC,CAAlB;IACA9F,GAAG,CAACkE,cAAJ,CAAmBD,WAAnB;EACH,CAHD;;EAIA/D,KAAK,CAAC6F,QAAN,GAAiB,UAAUF,KAAV,EAAiBC,GAAjB,EAAsB;IACnC,IAAIlD,IAAI,GAAG1C,KAAK,CAACG,WAAjB;IAEA,IAAI2F,IAAI,GAAGpD,IAAI,CAACR,KAAL,CAAWyD,KAAX,CAAX;IACAjD,IAAI,CAACR,KAAL,CAAWyD,KAAX,IAAoBjD,IAAI,CAACR,KAAL,CAAW0D,GAAX,CAApB;IACAlD,IAAI,CAACR,KAAL,CAAW0D,GAAX,IAAkBE,IAAlB;IAEA9F,KAAK,CAACG,WAAN,GAAoBuC,IAApB;IACAhC,YAAY,CAAC;MACTE,IAAI,EAAEtB,qBAAqB,CAACK,gBADnB;MAETkB,OAAO,EAAEb,KAAK,CAACG;IAFN,CAAD,CAAZ;IAIAH,KAAK,CAACoC,OAAN,CAAcC,IAAd,CAAmB,eAAerC,KAAK,CAACG,WAAN,CAAkBc,GAApD;EACH,CAbD,CA9WgC,CA4XhC;EAIA;;;EACAjB,KAAK,CAAC+F,gBAAN,GAAyB,YAAY;IACjCrF,YAAY,CAAC;MACTE,IAAI,EAAEtB,qBAAqB,CAACE,kBADnB;MAETqB,OAAO,EAAE;IAFA,CAAD,CAAZ;EAIH,CALD,CAjYgC,CAuYhC;;;EACAb,KAAK,CAACkF,eAAN,GAAwB,YAAY;IAChC,eAAec,oBAAf,GAAsC;MAClC,MAAMzE,QAAQ,GAAG,MAAMtC,GAAG,CAAC6C,gBAAJ,EAAvB;;MACA,IAAIP,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;QACvB,IAAIK,UAAU,GAAGR,QAAQ,CAACE,IAAT,CAAcvB,WAA/B;QACAQ,YAAY,CAAC;UACTE,IAAI,EAAEtB,qBAAqB,CAACI,kBADnB;UAETmB,OAAO,EAAEkB;QAFA,CAAD,CAAZ;MAIH,CAND,MAOK;QACDsC,OAAO,CAACC,GAAR,CAAY,kCAAZ;MACH;IACJ;;IACD0B,oBAAoB;EACvB,CAfD;;EAgBAhG,KAAK,CAACiG,cAAN,GAAuB,UAAU7E,EAAV,EAAc;IACjC,eAAe8E,mBAAf,CAAmC9E,EAAnC,EAAuC;MACnC,IAAIG,QAAQ,GAAG,MAAMtC,GAAG,CAACuC,eAAJ,CAAoBJ,EAApB,CAArB;;MACA,IAAIG,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;QACvB,IAAIX,QAAQ,GAAGQ,QAAQ,CAACE,IAAT,CAAcV,QAA7B;;QAEA,IAAIQ,QAAQ,CAACE,IAAT,CAAcC,OAAlB,EAA2B;UACvBhB,YAAY,CAAC;YACTE,IAAI,EAAEtB,qBAAqB,CAACK,gBADnB;YAETkB,OAAO,EAAEE;UAFA,CAAD,CAAZ;UAIAf,KAAK,CAACoC,OAAN,CAAcC,IAAd,CAAmB,eAAetB,QAAQ,CAACE,GAA3C;QACH;MACJ;IACJ;;IACDiF,mBAAmB,CAAC9E,EAAD,CAAnB;EACH,CAhBD;;EAiBApB,KAAK,CAACmG,eAAN,GAAwB,YAAY;IAChC,OAAOnG,KAAK,CAACG,WAAN,CAAkB+B,KAAlB,CAAwBkE,MAA/B;EACH,CAFD;;EAGApG,KAAK,CAACqG,IAAN,GAAa,YAAY;IACrBvG,GAAG,CAACwG,eAAJ;EACH,CAFD;;EAGAtG,KAAK,CAACuG,IAAN,GAAa,YAAY;IACrBzG,GAAG,CAAC0G,aAAJ;EACH,CAFD,CA/agC,CAmbhC;;;EACAxG,KAAK,CAACyG,iBAAN,GAA0B,YAAY;IAClC/F,YAAY,CAAC;MACTE,IAAI,EAAEtB,qBAAqB,CAACM,yBADnB;MAETiB,OAAO,EAAE;IAFA,CAAD,CAAZ;EAIH,CALD,CApbgC,CA2bhC;;;EACA,OAAO;IAAEb,KAAF;IAASU;EAAT,CAAP;AACH,CA7bM;;GAAMX,c"},"metadata":{},"sourceType":"module"}